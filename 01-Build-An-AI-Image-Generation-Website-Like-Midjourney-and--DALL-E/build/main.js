const form=document.getElementById("form"),imageGallery=document.getElementById("image-gallery"),OPENAI_API_KEY="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";let isImageGenerating=!1;const updateImageCard=e=>{e.map((e,a)=>{let t=imageGallery.querySelectorAll(".img-card")[a],n=t.querySelector("img"),i=t.querySelector(".download-btn"),r=`data:image/jpeg;base64,${e.b64_json}`;n.src=r,n.addEventListener("load",()=>{t.classList.remove("loading"),i.setAttribute("href",r),i.setAttribute("download",`${new Date().getTime()}.jpg`)})})},generateAIImages=async(e,a)=>{try{let t=await fetch("https://api.openai.com/v1/images/generations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer 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"},body:JSON.stringify({prompt:e,n:parseInt(a),size:"512x512",response_format:"b64_json"})});if(await console.log(t.json()),!t.ok)throw Error("Faild to generate images! Please try again.");let{data:n}=await t.json();console.log(n),updateImageCard([...n])}catch(i){alert(i.message)}finally{isImageGenerating=!1}},submitHandler=e=>{if(e.preventDefault(),isImageGenerating)return;isImageGenerating=!0;let a=e.srcElement[0].value,t=e.srcElement[1].value,n=Array.from({length:t},()=>`<div class="img-card loading">
    <img src="images/loader.svg" alt="Image">
    <a href="#" class="download-btn">
        <img src="images/download.svg" alt="Download Iocn">
    </a>
</div>`).join("");imageGallery.innerHTML=n,generateAIImages(a,t)};form.addEventListener("submit",submitHandler);